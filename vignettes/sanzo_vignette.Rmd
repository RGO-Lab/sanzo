---
title: "sanzo_vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{sanzo_vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


# ```sanzo```

# Color Palettes Based on the Works of Sanzo Wada

An R package by JRMA Maasch (2019).

```{r, include = FALSE}

# Load packages for ggplot2 demos.
library(ggplot2)
library(ggthemes)

data("iris")

# Read in data for ggplot2 demos.
raw <- read.csv("/Users/razel/Desktop/PROGS/R_practice/2019/sth_plasmid_ct_mean_raw.csv")
mean <- read.csv("/Users/razel/Desktop/PROGS/R_practice/2019/sth_plasmid_ct_mean.csv")

```

```{r setup}
# Install package if needed.
# devtools::install_github("jmaasch/sanzo")

# Load.
library(sanzo)
```

# Functions.
* ```sanzo.duo()``` : create duo palette
* ```sanzo.trio()``` : create trio palette
* ```sanzo.quad()``` : create quad palette
* ```sanzo.demo2()``` : print demo plots for all duo palettes
* ```sanzo.demo3()``` : print demo plots for all trio palettes
* ```sanzo.demo4()``` : print demo plots for all quad palettes
* ```sanzo.demo.all()``` : print demo plots for all palettes
* ```sanzo.info2()``` : generate dataframe of hexadecimals and urls for all duo palettes
* ```sanzo.info3()``` : generate dataframe of hexadecimals and urls for all trio palettes
* ```sanzo.info4()``` : generate dataframe of hexadecimals and urls for all quad palettes
* ```sanzo.info.all()``` : generate dataframe of hexadecimals and urls for all palettes

# Use with ggplot2.

## Scatter plot.
```theme_tufte``` (via ```ggthemes``` extension), ```alpha = 3/4```.

```{r gg_scatter1, warning = FALSE}

ggplot(iris, aes(Sepal.Length, Sepal.Width, color = as.factor(Species))) + 
  geom_point(aes(),
             size = 2, 
             alpha = 3/4) +
  geom_rug() + 
  theme_tufte(ticks = FALSE) + 
  scale_color_manual(name = "SPECIES", 
                     values = sanzo.trio("c205")) + 
  scale_shape_manual(name = "", 
                     values = c(17, 18, 19)) + 
  theme(axis.text = element_text(size = 8),
        axis.title = element_text(size = 10),
        plot.title = element_text(size = 10, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 10)) +
  labs(y = "SEPAL WIDTH\n", 
        x = "\n SEPAL LENGTH", 
        title = "COMBINATION 205\n") + 
  geom_smooth(method = lm, 
              se = FALSE, 
              color = "darkslategray", 
              size = 0.5) +
  geom_abline(intercept = 0, 
              slope = 1, 
              linetype = "dotted",
              color = "ivory3") +
  coord_fixed()

```

## Violin plot.

```{r violin_data, echo = FALSE}
  x1 <- rnorm(40, mean = 80.2, sd = 4)
  x2 <- rnorm(20, mean = 75.3, sd = 5)
  x3 <- rnorm(30, mean = 63.3, sd = 4)
  x4 <- rnorm(20, mean = 55.8, sd = 3)
  
  y1 <- rnorm(40, mean = 55.8, sd = 3)
  y2 <- rnorm(20, mean = 63.3, sd = 4)
  y3 <- rnorm(30, mean = 55.8, sd = 5)
  y4 <- rnorm(20, mean = 80.2, sd = 4)
  
  x <- c(x1, x2, x3, x4)
  y <- c(y1, y2, y3, y4)
  
  category <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 
                3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4)
  
  df_scatter <- data.frame(x, y, category)

```

```{r violin, warning = FALSE}

ggplot(df_scatter, aes(category, x), color = as.factor(category)) + 
  geom_violin(aes(fill = factor(category)), trim = FALSE) + 
  theme_hc() + 
  scale_fill_manual(name = "", 
                     values = sanzo.quad("c339")) + 
  scale_color_manual(name = "", 
                     values = sanzo.quad("c339")) + 
  theme(axis.text = element_text(size = 8),
        axis.title = element_text(size = 10),
        plot.title = element_text(size = 10, face = "bold", hjust = 0.5),
        legend.position = "none") +
  labs(y = "", 
        x = "\nCombination 339", 
        fill = "", 
        title = "") +
  theme(aspect.ratio = 1)
```

## Use as gradient.
Continuous colors via ```scale_fill_gradientn```, ```theme_few``` (via ```ggthemes``` extension).

```{r gradient, warning = FALSE}

ggplot(faithfuld, aes(waiting, eruptions)) +
  geom_raster(aes(fill = density), interpolate = TRUE) +
  theme_few() +
  scale_fill_gradientn(colors = sanzo.duo("c114")) +
  labs(y = "", 
        x = "", 
        fill = "", 
        title = "Combination 114\n")

```

## Bar plot.

```{r stacked_bar, warning = FALSE}

ggplot(mean, aes(fill = Concentration, y = CT, x = Target)) + 
  geom_bar(stat = "identity") +
  theme_few() +
  scale_fill_manual(values = sanzo.quad("c268"), labels = c("A", "B", "C")) + 
  theme(axis.text = element_text(size = 8),
        axis.title = element_text(size = 10),
        plot.title = element_text(size = 10, face = "bold", hjust = 0.5),
        legend.title = element_text(size = 10),
        legend.position = "right",
        legend.direction = "vertical") +
  scale_x_discrete(labels = c("1", "2", "3")) +
  labs(y = "", 
        x = "", 
        fill = "", 
        title = "Combination 268")

```
